<table width="60%">
    <tr>
        <td width="30%">
    Users <a routerLink="../newUser">(+)</a>
        </td>
        <td width="40%" *ngIf="isAdminUser()">
        <ng-select name="community_id" [items]="communities"
                   bindLabel="name"
                   bindValue="id"
                   placeholder="Community"
                   [(ngModel)]="community_id"
                   (change)="refreshUsersList()">
           </ng-select>
        </td>
        <td width="30%">
                <input type="checkbox" [(ngModel)]="activeRecords" (ngModelChange)="filterActiveRecords()"> Active
                <input type="checkbox" [(ngModel)]="inactiveRecords" (ngModelChange)="filterActiveRecords()"> Inactive
        </td>
    </tr>
</table>
<h4r-pagination [pageSettings]="pageSettings"></h4r-pagination>
 <table width="100%"> 
  <tr>
    <th width="17%">User</th>
    <th>Login</th> 
    <th>Email</th>
    <th>Avatar</th>
    <th>Community</th>
    <th title="Subscription years">#</th>
    <th title="subscription end date">Ends(d-m-y)</th>
    <th>Joined</th>
    <th>Admin?</th>
    <th *ngIf="currentUser.admin == true">Actions</th>
  </tr>
  <tr *ngFor="let user of pageSettings.getPaginatedList()">
    <td>
        <a routerLink="../editUser/{{user.id}}">{{user.fullName}} (
        <fa-icon *ngIf="user.sex == 1" [icon]="['fas', 'male']"></fa-icon>
        <fa-icon *ngIf="user.sex == 2" [icon]="['fas', 'female']"></fa-icon>
        <fa-icon *ngIf="user.sex == 0" [icon]="['fas', 'transgender']"></fa-icon>
        )
    </a></td>
    <td>{{user.login}}</td>
    <td>{{user.email}}</td>
    <td><img [src]="user.avatarURL" height="30" width="30"></td>
    <td>{{user.community && user.community.name}}</td>
    <td>
        <input *ngIf="user.admin != true" type="text" [(ngModel)]="user.subscriptionType" name="subscriptionType" size="2" (change)="changeSubscription(user)"/>
        <label *ngIf="user.admin == true">{{user.subscriptionType}}</label>
    </td>
    <td>{{user.subscriptionEndDate}}</td>
    <td>{{user.createdAt}}</td>
    <td><input *ngIf="((currentUser.id !=user.id) || (currentUser.admin != true))" type="checkbox" [(ngModel)]="user.promote2Admin" (change)="promoteUser(user)"></td>
    <td>
        <div *ngIf="currentUser.admin == true" class="btn-group">
                <button class="btn btn-success btn-sm dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Actions
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                  <a class="dropdown-item" title="Reset user's login password." 
                                    href="#" (click)="resetPasswordAdmin(user)">Password reset</a>
                  <a class="dropdown-item" title="Update user entitlement"
                                    href="#" routerLink="../userentitlement/{{user.id}}">Entitlement</a>
                </div>
        </div>    
    </td>
  </tr>
</table>
<h4r-pagination [pageSettings]="pageSettings"></h4r-pagination>
